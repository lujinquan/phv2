<!-- 房屋统计报表 -->
<div class="j-table-content j-no-title j-reportform">
	<div class="page-toolbar j-page-toolbar clearfix">
	      <form class="layui-form layui-form-pane" id="report-form">
			<div class="j-search-fl layui-col-md6  fl">
		        {if condition="INST_LEVEL != 3"}
				<div class="layui-input-inline" style="width:140px;">
					<select name="inst_id" id="TubulationI">
					  {volist name=":config('inst_check_names')[INST]" id="v"}
					  <option value="{$key}"{if condition="$key == $Think.INST"}selected{/if}>{$v}</option>
					  {/volist}
					</select>
				</div>
				{/if}
				<div class="layui-input-inline j-width-90 j-margin-10">
					<select name="owner_id" xm-select="ban_owner_id" id="OwnerTyp">
						<option disabled="disabled" value="">产别</option>
						{volist name="params['owners']" id="v"}
						<option value="{$key}">{$v}</option>
						{/volist}
					</select>
				</div>
			  <!-- <div class="layui-input-inline" style="width:140px;padding-left:5px">
			      <select name="owner_id" id="QueryTyp" lay-filter="owner_id">
			          <option value="1">按完损等级</option>
			          <option value="2">按使用性质</option>
			          <option value="3">按所属机构</option>
			          <option value="4">按建成年份</option>
			          <option value="5" selected>按房屋价值</option>
			      </select>
			  </div> -->
	          <div class="layui-input-inline" style="width:120px;padding-left:5px">
	              <input type="text" name="query_month" value="{:date('Y-m')}" readonly placeholder="月份" id="timeYear" autocomplete="off" class="layui-input">
	          </div>
	        </div>
			
	        <div class="j-search-fr layui-col-md6 fr">
	          <div class="layui-input-inline fr">
				<button type="reset" class="layui-btn j-btn-reset">重置</button>
				<button type="button" class="layui-btn"  id="yueQuery" lay-submit lay-filter="formDemo">
				    <i class="layui-icon">&#xe615;</i>
				    搜索
				</button>
				<button type="button" class="layui-btn layui-btn-warm on" onclick="click_print()" id="button_print">
				    <i class="layui-icon layui-icon-print"></i>
				    打印
				</button>
				{if condition="in_array(350,$auths) || $Think.ADMIN_ROLE == 1"}
				<button type="button" class="layui-btn layui-bg-green on" id="button_create">
				    <i class="layui-icon layui-icon-chart"></i>
				    生成本月报表
				</button>
				{/if}
	          </div>
			</div>
	      </form>
	  </div>
	   <!--startprint1-->
	  <div class="j-report-con">
		  <h1 class="j-report-title">武房异动统计表</h1>
		  <div class="j-report-table">
			  <ul>
				 <!-- <li><div class="DQueryType j-bold-size">按房屋价值</div></li>
				  <li><div class="time j-bold-size"></div></li>
				  <li><div class="fontsize j-bold-size">单位：建筑面积：平方米 规定租金：元</div></li> -->
				  <li class="j-bold-size">填报单位:<span class="fontsize DOwnerTyp"></span></li>
				  <li class="j-bold-size">产别:<span class="OwnerID"></span></li>
				  <li class="j-bold-size">填报时间:<span class="time"></span></li>
			  </ul>
			  <table class="layui-table">
				  <tbody class="one">
					  <tr>
						  <td colspan="18" align="center">非基数异动统计表 <span class="j-size-color">（*生效时间为<label class="nexttime"></label>）</span></td>
					  </tr>
					  <tr>
						  <th rowspan="2" colspan="2" class="j-bold-size">异动类别</th>
						  <th rowspan="1" colspan="4" class="j-bold-size">合计</th>
						  <th rowspan="1" colspan="4" class="j-bold-size">(一)工商企事业用房</th>
						  <th rowspan="1" colspan="4" class="j-bold-size">(二)党政机关用房</th>
						  <th rowspan="1" colspan="4" class="j-bold-size">(三)民用住宅用房</th>
					  </tr>
					  <tr>
						  <td rowspan="1" colspan="1" >上期结转</td>
						  <td rowspan="1" colspan="1" >新增异动</td>
						  <td rowspan="1" colspan="1" >失效异动</td>
						  <td rowspan="1" colspan="1" >有效异动</td>
						  <td rowspan="1" colspan="1" >上期结转</td>
						  <td rowspan="1" colspan="1" >新增异动</td>
						  <td rowspan="1" colspan="1" >失效异动</td>
						  <td rowspan="1" colspan="1" >有效异动</td>
						  <td rowspan="1" colspan="1" >上期结转</td>
						  <td rowspan="1" colspan="1" >新增异动</td>
						  <td rowspan="1" colspan="1" >失效异动</td>
						  <td rowspan="1" colspan="1" >有效异动</td>
						  <td rowspan="1" colspan="1" >上期结转</td>
						  <td rowspan="1" colspan="1" >新增异动</td>
						  <td rowspan="1" colspan="1" >失效异动</td>
						  <td rowspan="1" colspan="1" >有效异动</td>
					  </tr>
					  <tr class="Wsdj">
						  <td rowspan="1" colspan="2" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
					  </tr>
				  </tbody>      
			  </table>
			  <table class="layui-table">
				  <tbody class="two">
					  <tr>
					  	  <td colspan="26" align="center">基数异动统计表<span class="j-size-color">（*生效时间为<label class="nexttime"></label>）</span></td>
					  </tr>
					  <tr>
						  <th rowspan="2" colspan="2" class="j-bold-size j-width">异动类型</th>
						  <th rowspan="1" colspan="6" class="j-bold-size">合计</th>
						  <th rowspan="1" colspan="6" class="j-bold-size">(一)工商企事业用房</th>
						  <th rowspan="1" colspan="6" class="j-bold-size">(二)党政机关用房</th>
						  <th rowspan="1" colspan="6" class="j-bold-size">(三)民用住宅用房</th>
					  </tr>
					  <tr>
						  <td rowspan="1" colspan="1" >栋数</td>
						  <td rowspan="1" colspan="1" >规定租金</td>
						  <td rowspan="1" colspan="1" >计租面积</td>
						  <td rowspan="1" colspan="1" >建筑面积</td>
						  <td rowspan="1" colspan="1" >原价</td>
						  <td rowspan="1" colspan="1" >户数</td>
						  <td rowspan="1" colspan="1" >栋数</td>
						  <td rowspan="1" colspan="1" >规定租金</td>
						  <td rowspan="1" colspan="1" >计租面积</td>
						  <td rowspan="1" colspan="1" >建筑面积</td>
						  <td rowspan="1" colspan="1" >原价</td>
						  <td rowspan="1" colspan="1" >户数</td>
						  <td rowspan="1" colspan="1" >栋数</td>
						  <td rowspan="1" colspan="1" >规定租金</td>
						  <td rowspan="1" colspan="1" >计租面积</td>
						  <td rowspan="1" colspan="1" >建筑面积</td>
						  <td rowspan="1" colspan="1" >原价</td>
						  <td rowspan="1" colspan="1" >户数</td>
						  <td rowspan="1" colspan="1" >栋数</td>
						  <td rowspan="1" colspan="1" >规定租金</td>
						  <td rowspan="1" colspan="1" >计租面积</td>
						  <td rowspan="1" colspan="1" >建筑面积</td>
						  <td rowspan="1" colspan="1" >原价</td>
						  <td rowspan="1" colspan="1" >户数</td>
					  </tr>
					  <tr class="Syxz">
						  <td rowspan="1" colspan="2" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
						  <td rowspan="1" colspan="1" ></td>
					  </tr>
					  
				  </tbody>
			  </table>
			  <table class="layui-table">
				  <tbody class="three">
					  <tr>
						<td colspan="18" align="center">租金异动统计表<span class="j-size-color">（*生效时间为<label class="time"></label>）</span></td>
					  </tr>
				      <tr>
				          <th rowspan="2" colspan="2" class="j-bold-size j-width">异动类型</th>
				          <th rowspan="1" colspan="4" class="j-bold-size">合计</th>
				          <th rowspan="1" colspan="4" class="j-bold-size">(一)工商企事业用房</th>
				          <th rowspan="1" colspan="4" class="j-bold-size">(二)党政机关用房</th>
				          <th rowspan="1" colspan="4" class="j-bold-size">(三)民用住宅用房</th>
				      </tr>
				      <tr>
				          <td rowspan="1" colspan="1">本月</td>
				          <td rowspan="1" colspan="1">以前月</td>
				          <td rowspan="1" colspan="1">以前年</td>
				          <td rowspan="1" colspan="1">小计</td>
				          <td rowspan="1" colspan="1">本月</td>
				          <td rowspan="1" colspan="1">以前月</td>
				          <td rowspan="1" colspan="1">以前年</td>
				          <td rowspan="1" colspan="1">小计</td>
						  <td rowspan="1" colspan="1">本月</td>
						  <td rowspan="1" colspan="1">以前月</td>
						  <td rowspan="1" colspan="1">以前年</td>
						  <td rowspan="1" colspan="1">小计</td>
						  <td rowspan="1" colspan="1">本月</td>
						  <td rowspan="1" colspan="1">以前月</td>
						  <td rowspan="1" colspan="1">以前年</td>
						  <td rowspan="1" colspan="1">小计</td>
				      </tr>
				      
				      <tr class="gig">
				          <td rowspan="1" colspan="2" ></td>
				          <td rowspan="1" colspan="1"></td>
				          <td rowspan="1" colspan="1"></td>
				          <td rowspan="1" colspan="1"></td>
				          <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
						  <td rowspan="1" colspan="1"></td>
				      </tr>
				      
				  </tbody>
			  </table>
		  </div>
	   <!--endprint1-->
</div>
{include file="system@block/layui" /}
<script type="text/javascript" src="__ADMIN_VIEWJS__/report_changes_archives.js?v={:config('hisiphp.version')}"></script>
<!-- 打印 S -->
<script type="text/javascript" src="__PUBLIC_JS__/print/jquery-pool.js?v={:config('hisiphp.version')}"></script>
<script type="text/javascript" src="__PUBLIC_JS__/print/jquery.jqprint-0.3.js?v={:config('hisiphp.version')}"></script>
<!-- 打印 E -->
<script>

    layui.use(['jquery', 'laydate', 'element','table'], function(){
        var laydate = layui.laydate,
		    $ = layui.$
			,element = layui.element
			,table = layui.table;

		$('#button_create').click(function(){
			var that = $(this);
			that.prop('disabled', true);
			that.addClass('layui-btn-disabled').removeClass('layui-bg-green').text('生成中，大约需要6分钟……');
			//return false;
			$.post('{:url('house/makeArchivesReport')}', function(res) {
				that.prop('disabled', false);
				that.removeClass('layui-btn-disabled').addClass('layui-bg-green').html('<i class="layui-icon layui-icon-chart"></i>生成本月报表');
                layer.msg(res.msg, {time:5000},function(){
                	archives_data();
                	//location.reload();
                });
            });

		})

        //年选择器
        laydate.render({
            elem: '#timeYear'
            ,btns: ['now', 'confirm']
            ,type: 'month'
			//,value: new Date() 
            ,isInitValue: true
            //,showBottom: false
			,ready: function(date){
                $('.layui-laydate li').click(function () {
                   $('.laydate-btns-confirm').trigger('click');
                });
            }
        });
		
    });
	//打印
	function  click_print(){
	 $(".j-report-con").jqprint();
	}
</script>
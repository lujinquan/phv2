<form class="layui-form" action="" method="post" >
  <div class="j-details-box floorWrap">
	<fieldset class="layui-elem-field layui-field-title j-field-box">
		<legend>基本信息</legend>
	</fieldset>
	<div class="layui-row layui-form-item layui-col-space90">
		<div class="layui-col-md12">
			<label class="j-form-label"><i class="red">*</i>房屋编号</label>
			<div class="j-input-inline j-tips">
				<input type="text" id="house_number" readonly value="{$data_info['house_info']['house_number']}" placeholder="点击查询" autocomplete="off" class="layui-input">
				<input type="hidden" name="ban_id" value="{$data_info['ban_id']}">
				<input type="hidden" name="house_id" value="{$data_info['house_id']}">
				<input type="hidden" name="tenant_id" value="{$data_info['tenant_id']}">
				<input type="hidden" name="id" value="{$data_info['id']}">
			</div>
		</div>
	</div>
		<table  class="layui-table">
		  <thead>
			  <tr>
			    <th>房屋编号</th>
			    <th>楼栋地址</th>
			    <th>机构</th>
			    <th>产别</th>
			    <th>使用性质</th>
			    <th>租户姓名</th>
			    <th>规定租金</th>
			  </tr>
		  </thead>
		  <tbody>
		    <tr>
		  	  <td id="house_numbers">&nbsp;{$data_info['house_info']['house_number']}</td>
			  <td id="building_address">&nbsp;{$data_info['ban_info']['ban_address']}</td>
			  <td id="mechanism">&nbsp;{$params.insts[$data_info['ban_info']['ban_inst_id']]}</td>
	    	  <td id="yield_differentiation">&nbsp;{$params.owners[$data_info['ban_info']['ban_owner_id']]}</td>
	    	  <td id="nature_usage">&nbsp;{$params.uses[$data_info['house_info']['house_use_id']]}</td>
	    	  <td id="tenant_name">&nbsp;{$data_info['tenant_info']['tenant_name']}</td>
			  <td id="prescribed_rent">&nbsp;{$data_info['house_info']['house_pre_rent']}</td>
		    </tr>
		  </tbody>
		</table>
	<div class="layui-row layui-form-item layui-col-space90">
		<div class="layui-col-md8">
			<label class="j-form-label">异动原因</label>
			<div class="j-input-inline">
				<input type="text" id="tenant_reason" name="change_remark" value="{$data_info['change_remark']}" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<fieldset id="item1" class="layui-elem-field layui-field-title j-field-box">
		<legend>异动信息</legend>
	</fieldset>
	<table  class="layui-table j-house-box">
	  <thead>
		  <tr>
		    <th>追加类型</th>
		    <th>以前年</th>
		    <th>以前月</th>
		  </tr>
	  </thead>
	 <tbody>
	   <tr>
	 	  <td id="write_type">金额</td>
		  <td id="before_year"><input type="number" name="before_year_rent" lay-verify="required" value="{$data_info['before_year_rent']}"  placeholder="请输入追加以前年金额" class="layui-input"></td>
		  <td id="before_month"><input type="number" name="before_month_rent" lay-verify="required" value="{$data_info['before_month_rent']}" placeholder="请输入追加以前月金额" class="layui-input"></td>
	   </tr>
	 </tbody>
	</table>
	<fieldset id="item1" class="layui-elem-field layui-field-title j-field-box">
		<legend>填报信息</legend>
	</fieldset>
    <div class="layui-row layui-form-item layui-col-space90">
    	<div class="layui-col-md12">
    		<div class="j-enclosure-upload clearfix">
    			<div class="j-enclosure-label">票据</div>
    			<div class="j-enclosure-label j-uplode-icon">
    				<i><img src="/static/system/image/Group8.png"></i>点击上传
    				<button type="button" class="layui-btn layui-btn-primary" id="upload_img1">上传图片</button>
    			</div>
    			<div class="layui-form-mid layui-word-aux">限制3M</div>
    		</div>
    		<div class="j-enclosure-imgs clearfix">
   				<div id="upload_img_list1" class="upload_img_list j-viewer-img">
   					{volist name="$data_info['change_imgs']" id="v"}
					{if condition="$v['file_type'] == 'RentAddPaper'"}
					<dd class="item_img" id="">
						<div class="operate">
							<i  class="layui-icon-close-fill layui-icon"></i>
						</div>
						<img src="{$v['file']}" class="img" ><input type="hidden" name="file[]" value="{$v['id']}" />
					</dd>
					{/if}
					{/volist}
   				</div>
   			</div>
    	</div>
    	<div class="layui-upload">
    	</div>
    </div>
  <div class="layui-row layui-form-item layui-col-space90">
		<div class="j-margin-btn">
			<a href="javascript:history.go(-1)" class="layui-btn layui-btn-primary">取消</a>
			<button type="submit" j-data="{'save_type':'save'}" class="layui-btn" lay-submit lay-filter="formSubmit">保存</button>
			<button type="submit" j-data="{'save_type':'submit'}" class="layui-btn" lay-submit lay-filter="formSubmit">保存并提交</button>
		</div>
	</div>
  </div>
</form>
{include file="system@block/layui" /}
<!-- 图片查看 -->
<link rel="stylesheet" href="__PUBLIC_JS__/viewer/viewer.min.css?v={:config('hisiphp.version')}">
<script type="text/javascript" src="__PUBLIC_JS__/viewer/viewer-jquery.min.js?v={:config('hisiphp.version')}"></script>
<script type="text/javascript">
	var upurl = "{:url('system/Api/upload')}?input=RentAddPaper&group=change&water=no"; //票据
	var duotu = true; //是否为多图上传true false
	layui.use(['jquery', 'laydate', 'upload', 'form','table'], function() {
		var table = layui.table
		    ,form = layui.form
			,$ = layui.jquery
			,upload = layui.upload
			,layer = layui.layer;	
		//身份证信息
		upload.render({
			elem: '#upload_img1',
			url: upurl,
			size: 1024*3,
			multiple: duotu,
			field: 'RentAddPaper',
			before: function(obj) {
				layer.msg('图片上传中...', {
					icon: 16,
					shade: 0.01,
					time: 0
				})
			},
			done: function(res) {
				layer.close(layer.msg()); //关闭上传提示窗口
				if (duotu == true) {
					//调用多图上传方法,其中res.imgid为后台返回的一个随机数字
					$('#upload_img_list1').append('<dd class="item_img" id="' + res.data.name +
						'"><div class="operate"><i  class="layui-icon-close-fill layui-icon"></i></div><img src="' + res.data.file +
						'" class="img" ><input type="hidden" name="file[]" value="' + res.data.id + '" /></dd>');
				} else {
					//调用单图上传方法,其中res.imgid为后台返回的一个随机数字
					$('#upload_img_list1').html('<dd class="item_img" id="' + res.data.name +
						'"><div class="operate"><i  class="layui-icon-close-fill layui-icon"></i></div><img src="' + res.data.file +
						'" class="img" ><input type="hidden" name="file[]" value="' + res.data.id + '" /></dd>');
				}
			}
		})
		/*
		删除上传图片
		*/
		$(document).on("click", ".upload_img_list dd i", function() {
			$(this).parents("dd").remove();
		})
	});
</script>
